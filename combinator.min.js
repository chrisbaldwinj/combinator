!function(){"use strict";function e(e,t,n){"addEventListener"in document?e.addEventListener(t,n):"attachEvent"in document?e.attachEvent("on"+t,n):e["on"+t]=n}function t(e,t,n){"addEventListener"in document?e.removeEventListener(t,n):"detachEvent"in document?e.attachEvent("on"+t,n):e["on"+t]=null}function n(e,n,r){r||(r=document);var i=this;addListener(r,"keydown",function a(o){i.waiting?keyCodes.literal[e.toUpperCase()]===o.which&&(n.call(i,o),i.waiting=!1,t(this,"keydown",a)):t(r,"keydown",a)})}function r(e){for(var t in y.cmd)e.call(y.cmd,t)}function i(t){t||(t=document),e(t,"keydown",function(e){var t,i,a,o,c;if(t="which"in e?e.which:e.keyCode,e.ctrlKey&&-1===p.indexOf("ctrl")&&p.push("ctrl"),e.altKey&&-1===p.indexOf("alt")&&p.push("alt"),e.shiftKey&&-1===p.indexOf("shift")&&p.push("shift"),p.length>0&&(g=!0,r(function(e){this[e].hasOwnProperty("waiting")&&delete this[e].waiting})),i=keyCodes.numerical[t],-1===p.indexOf(i)&&p.push(i),a=p.join("+").toLowerCase(),y.cmd.hasOwnProperty(a)){if(o=y.cmd[a],e.preventDefault(),e.stopPropagation(),!o.repeat&&o.executed||o.once&&o.called)return!1;if(o.repeat||(m=o),!o.input)for(c=e.target;c!=document.body;){if(!o.input&&("input"===c.tagName.toLowerCase()||"textarea"===c.tagName.toLowerCase()))return!1;if(!o.input&&c.hasAttribute("contenteditable")&&c.getAttribute("contenteditable")===!0)return!1;c=c.parentNode}if(null!==o.ignoreClass){var s=o.ignoreClass.replace(/\s+/g,"|");if(s=new RegExp(s,"gi"),s.test(this.className))return!1}o.waiting=!0,o.exec.call(e,n.bind(o)),o.executed=!0,o.called=!0,p=[],a=""}}),e(t,"keyup",function(e){var t,n,r="which"in e?e.which:e.keyCode;return n=p.join("+").toLowerCase(),17===r||18===r?(e.preventDefault(),g=!1,p=[],!1):(t=p.indexOf(keyCodes.numerical[r]),t>-1&&p.splice(t,1),null!==m&&(m.executed=!1),void 0)})}function a(e){return e=e.toLowerCase(),y.cmd.hasOwnProperty(e)?y.cmd[e]:null}function o(e){return e=e.toLowerCase(),y.cmd.hasOwnProperty(e)?(delete y.cmd[e],!0):!1}function c(e,t){var n={};if("string"!=typeof e)return new Error("The first argument for register must be a string combinator.");if(e=e.toLowerCase(),/Mac|iPod|iPhone|iPad/.test(navigator.platform)&&e.replace("ctrl","meta"),w.indexOf(e)>-1==!0)return new Error(e+" cannot be used, this is a system specific combinator");if(y.cmd.hasOwnProperty(e))return new Error(e+" already exists. Please release this combinator before overwriting.");if(e.split("+").length>4)return new Error(e+" is too long, the system can only handle four consecutive keys pressed.");for(var r in f)t.hasOwnProperty(r)&&"executed"!==r&&"called"!==r&&"waiting"!==r?n[r]=t[r]:n[r]=f[r];y.cmd[e]=n}function s(e){if(e=e.toLowerCase(),y.cmd.hasOwnProperty(e)){var t=y.cmd[e];t.waiting=!0,t.exec.call(y,n.bind(t))}}function d(n,r){return r||(r=document),h=!0,e(r,"keydown",function i(e){if(h){var r="which"in e?e.which:e.keyCode,a=keyCodes.numerical[r];n.call(this,a,e)}else t(this,"keydown",i)}),{stop:l}}function l(){h=!1}function u(e){return e=e.toLowerCase(),y.cmd.hasOwnProperty(e)?(y.cmd[e].executed=!1,y.cmd[e].called=!1,!0):!1}var w=["ctrl+n","ctrl+shift+n","ctrl+t","ctrl+shift+t","ctrl+w","ctrl+shift+w"],f={title:null,exec:function(){},repeat:!0,input:!0,once:!1,executed:!1,called:!1,ignoreClass:null},h=!1,p=[],m=null,g=!1;window.keyCodes={},window.keyCodes.numerical={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause/break",20:"caps lock",27:"escapse",33:"page up",34:"page down",35:"end",36:"home",37:"left arrow",38:"up arrow",39:"right arrow",40:"down arrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"left window",106:"multiply",107:"add",109:"subtract",110:"decimal point",111:"divide",186:"semi-colon",187:"equal sign",188:"comma",189:"dash",190:"period",191:"forward slash",192:"grave accent",219:"open bracket",220:"back slash",221:"close bracket",222:"single quote"},window.keyCodes.literal={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,escape:27,"page up":33,"page down":34,end:35,home:36,"left arrow":37,"up arrow":38,"right arrow":39,"down arrow":40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"left window":91,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,"semi-colon":186,"equal sign":187,comma:188,dash:189,period:190,"forward slash":191,"grave accent":192,"open bracket":219,"back slash":220,"close bracket":221,"single quote":222};var y={fetch:a,register:c,listen:i,release:o,reset:u,trigger:s,record:d,cmd:{}};window.commands=y}();
